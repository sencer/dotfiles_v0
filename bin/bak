#!/bin/bash

while [[ $# -gt 0 ]]; do
  if [[ $1 == -c ]]; then
    bak="cp"
  elif [[ ! -e $1 ]]; then
    echo "File $1 not found."
  elif [[ -z $i && ! -e $1.bak ]]; then
    ${bak:-mv} -vf $1 $1.bak
  else
    until [[ ! -e $1.${i:=1}.bak ]]; do
      let i++
    done
    ${bak:-mv} -vf $1 $1.$i.bak
  fi
  shift
done
exit $i
