#!/bin/bash

awk '/starts/ {
       last = 0
       mode = 0
       n[mode] += 1
     }
     /End of self-consistent/ {
       mode = 1
       n[mode] += 1
     }
     /iteration #/ {
       mode = 2
       n[mode] += 1
     }
     /total cpu time/ {
       t[mode] += $9 - last
       last = $9
     }
     END {
       printf "init: %.2f forces: %.2f scf: %.2f\n", t[0]/(n[0]?n[0]:1), t[1]/(n[1]?n[1]:1), t[2]/(n[2]?n[2]:1)
     }' ${1-output.txt}
