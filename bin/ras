#!/bin/bash

escape(){
  arg="$@"
  #why not in general?
  # ?arg="${arg/\*/\\*}"
  for i in \( \) \;;do  # \; makes find work, messes with for
    arg="${arg//$i/\\$i}"
  done
  echo "$arg"
}

command=`basename $0`
args="$(escape "$@")"


if [[ $SERVER == "" ]];then
  # echo "Trying to run locally..." >&2
  eval "\\$command"  #2>/dev/null ||
    #echo -e "$(tput cuu1)`basename $command` not found in PATH.    "
else
  if tmp=`grep "^$SERVER" $PBS_SERVER_FILE`; then
    read -a settings <<< $tmp
    folder=${settings[3]}
  fi
  ssh -q$o $SERVER "cd $folder${PWD#$HOME/$SERVER}; ${command}"
fi

